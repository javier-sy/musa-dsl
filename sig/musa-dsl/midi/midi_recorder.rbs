# RBS for midi/midi-recorder.rb - MIDI event recording and transcription

module Musa
  module MIDIRecorder
    # Collects raw MIDI bytes alongside sequencer position.
    class MIDIRecorder
      def initialize: (Sequencer::BaseSequencer sequencer) -> void

      # Clears all stored events.
      def clear: () -> void

      # Records one MIDI packet.
      def record: (String | Array[Integer] midi_bytes) -> void

      # Unprocessed recorded messages.
      def raw: () -> Array[untyped]

      # Converts buffer into a list of note hashes.
      #
      # Returns array of hashes with keys: :position, :channel, :pitch,
      # :velocity, :duration, :velocity_off. Silences have pitch: :silence.
      def transcription: () -> Array[Hash[Symbol, untyped]]
    end
  end
end
